%% -*- mode: erlang;erlang-indent-level: 4;indent-tabs-mode: nil -*-
%%======================================================================
%%
%% Leo Object Storage
%%
%% Copyright (c) 2012-2018 Rakuten, Inc.
%% Copyright (c) 2019-2025 Lions Data, Ltd.
%%
%% This file is provided to you under the Apache License,
%% Version 2.0 (the "License"); you may not use this file
%% except in compliance with the License.  You may obtain
%% a copy of the License at
%%
%%   http://www.apache.org/licenses/LICENSE-2.0
%%
%% Unless required by applicable law or agreed to in writing,
%% software distributed under the License is distributed on an
%% "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
%% KIND, either express or implied.  See the License for the
%% specific language governing permissions and limitations
%% under the License.
%%
%%======================================================================

%% Minimum OTP version
{minimum_otp_vsn, "19"}.

%% Plugins
{plugins, [pc]}.

%% Port compiler environment - fix for newer CMake versions
{port_env, [
    {"CFLAGS", "$CFLAGS -DCMAKE_POLICY_VERSION_MINIMUM=3.5"},
    {"CXXFLAGS", "$CXXFLAGS -DCMAKE_POLICY_VERSION_MINIMUM=3.5"}
]}.

%% Dependencies
{deps, [
        {leo_backend_db, {git, "https://github.com/leo-project/leo_backend_db.git", {tag, "2.1.0"}}}
       ]}.

%% Erlang compiler options
{erl_opts, [{d, 'NOTEST'},
            warn_obsolete_guard,
            warn_shadow_vars,
            warn_export_vars,
            warn_export_all
           ]}.

%% Xref checks
{xref_checks, [undefined_function_calls]}.

%% Cover
{cover_enabled, true}.

%% Profiles
{profiles, [
    {test, [
        {erl_opts, [debug_info, {d, 'TEST'}]},
        {deps, [
            {meck, "0.9.2"},
            {proper, {git, "https://github.com/proper-testing/proper.git", {tag, "v1.5.0"}}}
        ]}
    ]}
]}.

%% Dialyzer
{dialyzer, [
    {warnings, [unknown]},
    {plt_apps, all_deps}
]}.
